# Comparing `tmp/rayfed_nightly-0.1.0b20230602.dev0-py3-none-any.whl.zip` & `tmp/rayfed_nightly-0.1.0b20230620.dev0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,27 +1,27 @@
-Zip file size: 38902 bytes, number of entries: 25
--rw-r--r--  2.0 unx      853 b- defN 23-Jun-02 01:48 fed/__init__.py
--rw-r--r--  2.0 unx    15898 b- defN 23-Jun-02 01:48 fed/api.py
--rw-r--r--  2.0 unx    15662 b- defN 23-Jun-02 01:48 fed/barriers.py
--rw-r--r--  2.0 unx     3172 b- defN 23-Jun-02 01:48 fed/cleanup.py
--rw-r--r--  2.0 unx     2280 b- defN 23-Jun-02 01:48 fed/config.py
--rw-r--r--  2.0 unx     2877 b- defN 23-Jun-02 01:48 fed/fed_object.py
--rw-r--r--  2.0 unx     7908 b- defN 23-Jun-02 01:48 fed/tree_util.py
--rw-r--r--  2.0 unx     6735 b- defN 23-Jun-02 01:48 fed/utils.py
--rw-r--r--  2.0 unx      581 b- defN 23-Jun-02 01:48 fed/_private/__init__.py
--rw-r--r--  2.0 unx      581 b- defN 23-Jun-02 01:48 fed/_private/api.py
--rw-r--r--  2.0 unx     4487 b- defN 23-Jun-02 01:48 fed/_private/compatible_utils.py
--rw-r--r--  2.0 unx     1268 b- defN 23-Jun-02 01:48 fed/_private/constants.py
--rw-r--r--  2.0 unx     3837 b- defN 23-Jun-02 01:48 fed/_private/fed_actor.py
--rw-r--r--  2.0 unx     3825 b- defN 23-Jun-02 01:48 fed/_private/fed_call_holder.py
--rw-r--r--  2.0 unx     1017 b- defN 23-Jun-02 01:48 fed/_private/global_context.py
--rw-r--r--  2.0 unx     2859 b- defN 23-Jun-02 01:48 fed/_private/grpc_options.py
--rw-r--r--  2.0 unx     2386 b- defN 23-Jun-02 01:48 fed/_private/serialization_utils.py
--rw-r--r--  2.0 unx      581 b- defN 23-Jun-02 01:48 fed/grpc/__init__.py
--rw-r--r--  2.0 unx     5608 b- defN 23-Jun-02 01:48 fed/grpc/fed_pb2.py
--rw-r--r--  2.0 unx     2955 b- defN 23-Jun-02 01:48 fed/grpc/fed_pb2_grpc.py
--rw-r--r--  2.0 unx    11356 b- defN 23-Jun-02 01:50 rayfed_nightly-0.1.0b20230602.dev0.dist-info/LICENSE
--rw-r--r--  2.0 unx     7312 b- defN 23-Jun-02 01:50 rayfed_nightly-0.1.0b20230602.dev0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jun-02 01:50 rayfed_nightly-0.1.0b20230602.dev0.dist-info/WHEEL
--rw-r--r--  2.0 unx        4 b- defN 23-Jun-02 01:50 rayfed_nightly-0.1.0b20230602.dev0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     2053 b- defN 23-Jun-02 01:50 rayfed_nightly-0.1.0b20230602.dev0.dist-info/RECORD
-25 files, 106187 bytes uncompressed, 35604 bytes compressed:  66.5%
+Zip file size: 38981 bytes, number of entries: 25
+-rw-r--r--  2.0 unx      853 b- defN 23-Jun-20 01:36 fed/__init__.py
+-rw-r--r--  2.0 unx    15747 b- defN 23-Jun-20 01:36 fed/api.py
+-rw-r--r--  2.0 unx    15662 b- defN 23-Jun-20 01:36 fed/barriers.py
+-rw-r--r--  2.0 unx     3172 b- defN 23-Jun-20 01:36 fed/cleanup.py
+-rw-r--r--  2.0 unx     2280 b- defN 23-Jun-20 01:36 fed/config.py
+-rw-r--r--  2.0 unx     2877 b- defN 23-Jun-20 01:36 fed/fed_object.py
+-rw-r--r--  2.0 unx     7908 b- defN 23-Jun-20 01:36 fed/tree_util.py
+-rw-r--r--  2.0 unx     6735 b- defN 23-Jun-20 01:36 fed/utils.py
+-rw-r--r--  2.0 unx      581 b- defN 23-Jun-20 01:36 fed/_private/__init__.py
+-rw-r--r--  2.0 unx      581 b- defN 23-Jun-20 01:36 fed/_private/api.py
+-rw-r--r--  2.0 unx     5021 b- defN 23-Jun-20 01:36 fed/_private/compatible_utils.py
+-rw-r--r--  2.0 unx     1268 b- defN 23-Jun-20 01:36 fed/_private/constants.py
+-rw-r--r--  2.0 unx     3837 b- defN 23-Jun-20 01:36 fed/_private/fed_actor.py
+-rw-r--r--  2.0 unx     3825 b- defN 23-Jun-20 01:36 fed/_private/fed_call_holder.py
+-rw-r--r--  2.0 unx     1017 b- defN 23-Jun-20 01:36 fed/_private/global_context.py
+-rw-r--r--  2.0 unx     2859 b- defN 23-Jun-20 01:36 fed/_private/grpc_options.py
+-rw-r--r--  2.0 unx     2386 b- defN 23-Jun-20 01:36 fed/_private/serialization_utils.py
+-rw-r--r--  2.0 unx      581 b- defN 23-Jun-20 01:36 fed/grpc/__init__.py
+-rw-r--r--  2.0 unx     5608 b- defN 23-Jun-20 01:36 fed/grpc/fed_pb2.py
+-rw-r--r--  2.0 unx     2955 b- defN 23-Jun-20 01:36 fed/grpc/fed_pb2_grpc.py
+-rw-r--r--  2.0 unx    11356 b- defN 23-Jun-20 01:38 rayfed_nightly-0.1.0b20230620.dev0.dist-info/LICENSE
+-rw-r--r--  2.0 unx     7312 b- defN 23-Jun-20 01:38 rayfed_nightly-0.1.0b20230620.dev0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jun-20 01:38 rayfed_nightly-0.1.0b20230620.dev0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        4 b- defN 23-Jun-20 01:38 rayfed_nightly-0.1.0b20230620.dev0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2053 b- defN 23-Jun-20 01:38 rayfed_nightly-0.1.0b20230620.dev0.dist-info/RECORD
+25 files, 106570 bytes uncompressed, 35683 bytes compressed:  66.5%
```

## zipnote {}

```diff
@@ -54,23 +54,23 @@
 
 Filename: fed/grpc/fed_pb2.py
 Comment: 
 
 Filename: fed/grpc/fed_pb2_grpc.py
 Comment: 
 
-Filename: rayfed_nightly-0.1.0b20230602.dev0.dist-info/LICENSE
+Filename: rayfed_nightly-0.1.0b20230620.dev0.dist-info/LICENSE
 Comment: 
 
-Filename: rayfed_nightly-0.1.0b20230602.dev0.dist-info/METADATA
+Filename: rayfed_nightly-0.1.0b20230620.dev0.dist-info/METADATA
 Comment: 
 
-Filename: rayfed_nightly-0.1.0b20230602.dev0.dist-info/WHEEL
+Filename: rayfed_nightly-0.1.0b20230620.dev0.dist-info/WHEEL
 Comment: 
 
-Filename: rayfed_nightly-0.1.0b20230602.dev0.dist-info/top_level.txt
+Filename: rayfed_nightly-0.1.0b20230620.dev0.dist-info/top_level.txt
 Comment: 
 
-Filename: rayfed_nightly-0.1.0b20230602.dev0.dist-info/RECORD
+Filename: rayfed_nightly-0.1.0b20230620.dev0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## fed/api.py

```diff
@@ -165,15 +165,14 @@
     tls_config = {} if tls_config is None else tls_config
     if tls_config:
         assert (
             'cert' in tls_config and 'key' in tls_config
         ), 'Cert or key are not in tls_config.'
     # A Ray private accessing, should be replaced in public API.
     compatible_utils._init_internal_kv()
-    compatible_utils.kv.initialize()
 
     cluster_config = {
         constants.KEY_OF_CLUSTER_ADDRESSES: cluster,
         constants.KEY_OF_CURRENT_PARTY_NAME: party,
         constants.KEY_OF_TLS_CONFIG: tls_config,
         constants.KEY_OF_CROSS_SILO_SERIALIZING_ALLOWED_LIST:
             cross_silo_serializing_allowed_list,
@@ -224,17 +223,15 @@
 
 
 def shutdown():
     """
     Shutdown a RayFed client.
     """
     wait_sending()
-    compatible_utils.kv.delete(constants.KEY_OF_CLUSTER_CONFIG)
-    compatible_utils.kv.delete(constants.KEY_OF_JOB_CONFIG)
-    compatible_utils.kv.reset()
+    compatible_utils._clear_internal_kv()
     clear_global_context()
     logger.info('Shutdowned rayfed.')
 
 
 def _get_cluster():
     """
     Get the RayFed cluster configration.
```

## fed/_private/compatible_utils.py

```diff
@@ -14,14 +14,15 @@
 
 import abc
 import ray
 import fed._private.constants as fed_constants
 
 import ray.experimental.internal_kv as ray_internal_kv
 from ray._private.gcs_utils import GcsClient
+from fed._private import constants
 
 
 def _compare_version_strings(version1, version2):
     """
     This utility function compares two version strings and returns
     True if version1 is greater, and False if they're equal, and
     False if version2 is greater.
@@ -148,16 +149,33 @@
     def reset(self):
         o = self._internal_kv_actor.reset.remote()
         return ray.get(o)
 
 
 def _init_internal_kv():
     """An internal API that initialize the internal kv object."""
-    from ray._private.client_mode_hook import is_client_mode_enabled
-    if is_client_mode_enabled:
-        kv_actor = ray.remote(InternalKv).options(name="_INTERNAL_KV_ACTOR").remote()
-        response = kv_actor._ping.remote()
-        ray.get(response)
-    return ClientModeInternalKv() if is_client_mode_enabled else InternalKv()
+    global kv
+    if kv is None:
+        from ray._private.client_mode_hook import is_client_mode_enabled
+        if is_client_mode_enabled:
+            kv_actor = ray.remote(InternalKv).options(
+                name="_INTERNAL_KV_ACTOR").remote()
+            response = kv_actor._ping.remote()
+            ray.get(response)
+        kv = ClientModeInternalKv() if is_client_mode_enabled else InternalKv()
+        kv.initialize()
+
+
+def _clear_internal_kv():
+    global kv
+    if kv is not None:
+        kv.delete(constants.KEY_OF_CLUSTER_CONFIG)
+        kv.delete(constants.KEY_OF_JOB_CONFIG)
+        kv.reset()
+        from ray._private.client_mode_hook import is_client_mode_enabled
+        if is_client_mode_enabled:
+            _internal_kv_actor = ray.get_actor("_INTERNAL_KV_ACTOR")
+            ray.kill(_internal_kv_actor)
+        kv = None
 
 
-kv = _init_internal_kv()
+kv = None
```

## Comparing `rayfed_nightly-0.1.0b20230602.dev0.dist-info/LICENSE` & `rayfed_nightly-0.1.0b20230620.dev0.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `rayfed_nightly-0.1.0b20230602.dev0.dist-info/METADATA` & `rayfed_nightly-0.1.0b20230620.dev0.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: rayfed-nightly
-Version: 0.1.0b20230602.dev0
+Version: 0.1.0b20230620.dev0
 Summary: A multiple parties joint, distributed execution engine based on Ray,to help build your own federated learning frameworks in minutes.
 Home-page: https://github.com/ray-project/rayfed
 Author: RayFed Team
 Author-email: rayfed-dev@googlegroups.com
 License: Apache 2.0
 Platform: UNKNOWN
 Description-Content-Type: text/markdown
```

## Comparing `rayfed_nightly-0.1.0b20230602.dev0.dist-info/RECORD` & `rayfed_nightly-0.1.0b20230620.dev0.dist-info/RECORD`

 * *Files 9% similar despite different names*

```diff
@@ -1,25 +1,25 @@
 fed/__init__.py,sha256=6Xds1gLndBN-E4GBTuxnc7gf3Zw_D8iNejjA3JTjWnc,853
-fed/api.py,sha256=VCM9NfdmhQAdA8b2lK-f4D_5fWzRY0xek4tGy1yvchI,15898
+fed/api.py,sha256=zX6J5f8pjbwQRY_kzzVQrbiGXZv8M9KEKXEJIlTbpqY,15747
 fed/barriers.py,sha256=ZBT8P4p7MXC8fqW7hQb6EWEHCU4GsAbNzCseEKicdqA,15662
 fed/cleanup.py,sha256=pYuljYQzeQg572MbbtxdAa1D2-_sZ9hd7Hi4qSippnA,3172
 fed/config.py,sha256=bpflURNHjH224XWM9BUgvMLzH-3BRzZJ_oX0PtdErrw,2280
 fed/fed_object.py,sha256=l2BRa9WZ3jqXSDjwFPURcAIK8XkH8A5UYA_OcY4TOD0,2877
 fed/tree_util.py,sha256=25LiGASBcreE34OsGsoeRWH4t6BuBk3QVcKjCe38jTI,7908
 fed/utils.py,sha256=FfvqkErgpJ7U9r5pm8rzjzAQhEvrZyI-xUkTfU6l5F0,6735
 fed/_private/__init__.py,sha256=MDXwlZ-y7_o-tfqh8DVkjlO-6MlWqwLdbSIZUJfXtF0,581
 fed/_private/api.py,sha256=MDXwlZ-y7_o-tfqh8DVkjlO-6MlWqwLdbSIZUJfXtF0,581
-fed/_private/compatible_utils.py,sha256=ZhaLX797pZ-PnwlNIMgRzkwrysW0wbruQLHm-WsNUUs,4487
+fed/_private/compatible_utils.py,sha256=eLnZiO0xn4Ganrd1J5cCSu1gRjV9BhqEryrXQZANuFo,5021
 fed/_private/constants.py,sha256=r0vt4ueAsB3cyNVOQ8lJZgCCDosYHgNYZblaUfapk1o,1268
 fed/_private/fed_actor.py,sha256=8nqXO_l9yOno5duMiEhWagp9q9-w696erKos-RgcnoU,3837
 fed/_private/fed_call_holder.py,sha256=uJhmyq1nIn4nqJUg1bOqjgXrgFscZHsdpi5pXrXPF2M,3825
 fed/_private/global_context.py,sha256=dlfeqdp6C_5bGDvzHcxbR6xZGELfVyoQtDIZ4ampwZw,1017
 fed/_private/grpc_options.py,sha256=_r43xjQfg0JmD0T447wHV42EYhP0YpBubsGKG22TuN4,2859
 fed/_private/serialization_utils.py,sha256=l63nacVabcyKpys9tVT2zUMmKecimeVflsJ6v45AYvc,2386
 fed/grpc/__init__.py,sha256=MDXwlZ-y7_o-tfqh8DVkjlO-6MlWqwLdbSIZUJfXtF0,581
 fed/grpc/fed_pb2.py,sha256=CKRJyBIx8MG4XtqtARL9ETFEyIsX2ksO0IVU9JgBhWQ,5608
 fed/grpc/fed_pb2_grpc.py,sha256=PsTotUwY4gEHWV0gQnPwpoQWdNJCczNZti6bJBYFj5Q,2955
-rayfed_nightly-0.1.0b20230602.dev0.dist-info/LICENSE,sha256=QwcOLU5TJoTeUhuIXzhdCEEDDvorGiC6-3YTOl4TecE,11356
-rayfed_nightly-0.1.0b20230602.dev0.dist-info/METADATA,sha256=EQv3Al-7el2f5d0rY_b_cSr6BqCVyCZ1N2NnzYJEnpE,7312
-rayfed_nightly-0.1.0b20230602.dev0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-rayfed_nightly-0.1.0b20230602.dev0.dist-info/top_level.txt,sha256=5gd1qhbpzLAi36ONV8p_s65_-iAiOSwFljYh-ONEwts,4
-rayfed_nightly-0.1.0b20230602.dev0.dist-info/RECORD,,
+rayfed_nightly-0.1.0b20230620.dev0.dist-info/LICENSE,sha256=QwcOLU5TJoTeUhuIXzhdCEEDDvorGiC6-3YTOl4TecE,11356
+rayfed_nightly-0.1.0b20230620.dev0.dist-info/METADATA,sha256=cU_emYOPqQZo7yOoh66GL0xjPPrdOwWqB8nOqB_HXEA,7312
+rayfed_nightly-0.1.0b20230620.dev0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+rayfed_nightly-0.1.0b20230620.dev0.dist-info/top_level.txt,sha256=5gd1qhbpzLAi36ONV8p_s65_-iAiOSwFljYh-ONEwts,4
+rayfed_nightly-0.1.0b20230620.dev0.dist-info/RECORD,,
```

